#!/usr/bin/bash
function getFileName
{
    local -r key="$1"
    local -Ar fileNames=(
        ["hw_brightness_tracker"]="hardware_brightness_tracker"
        ["hw_brightness_ctl"]="hardware_brightness_controller"
        ["max_hw_brightness"]="max_hardware_brightness"
        ["sw_brightness_tracker"]="software_brightness_tracker"
        ["xrandr_verbose_cache"]="software_dim_buffer"
        ["og_hw_dim_enabled"]="og_hardware_dim_enabled"
        ["og_hw_source_code"]="og_hardware_source_code.c"
    );

    echo "${OG_DIM_DIR}/${fileNames["${key}"]}"
}

function isOgdimRunningInValidEnv
{
    # only run program from symbolic link to make handling of software
    # and hardware versions of ogdim cleaner and make version ctl easier
    local -r self="$0"
    if ! [[ -L "$self" ]]; then exit 1; fi

}


function createHardwareDimExecutable
{
    echo ''
}

function getUserInputFilePath
{
    local -r prompt="$1"
    read -rp "$prompt" path
    [[ -e "$path" ]]
    echo "$path"
}

function initHardwareDim
{
    read -rp 'Enable hardware dimming? (must have software dimmable backlight) [y/n]: ' response
    if grep -q -v -i '^y' <<< "$response"; then return 0; fi
    touch "$(getFileName "og_hw_dim_enabled")" # if file exists, hw dim is enabled
}


function initSetup
{
    if ! isOgdimRunningInValidEnv; then exit 1; fi

    mkdir -p "${OG_DIM_DIR}"
    read -rp 'Enable hardware dimming (must have software dimmable backlight)'
}

case "$1" in
    --init)

        ;;
esac

initSetup
# "/home/spaceface102/.og.d/Dim/brightness_tracker";
# "/sys/class/backlight/intel_backlight/brightness";
# "/sys/class/backlight/intel_backlight/max_brightness";
# OG_DIM_DIR